<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org/"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout.html}"
      lang="en">

<div layout:fragment="content">
    <div class="card" style="width: 85%;">
        <h2 class="section-title">üì¢Í≥µÏßÄÏÇ¨Ìï≠</h2>
                <div class="notice-card" >
                    <div class="notice-header">
                        <form action="/notices/list" method="get">
                            <input type="hidden" name="size" th:value="${pageRequestDTO.size}">
                                <div class="col">
                                    <div class="input-group mt-3 mb-lg-3">
                                        <div class="input-group-prepend">
                                            <select class="form-select" name="type">
                                                <option value="">---</option>
                                                <option value="t" th:selected="${pageRequestDTO.type=='t'}">Ï†úÎ™©</option>
                                                <option value="c" th:selected="${pageRequestDTO.type=='c'}">ÎÇ¥Ïö©</option>
                                                <option value="w" th:selected="${pageRequestDTO.type=='w'}">ÏûëÏÑ±Ïûê</option>
                                                <option value="tc" th:selected="${pageRequestDTO.type=='tc'}">Ï†úÎ™©+ÎÇ¥Ïö©</option>
                                                <option value="tcw" th:selected="${pageRequestDTO.type=='tcw'}">Ï†úÎ™©+ÎÇ¥Ïö©+ÏûëÏÑ±Ïûê</option>
                                            </select>
                                        </div>
                                        <input type="text" class="input-control" name="keyword" th:value="${pageRequestDTO.keyword}">
                                        <button class="btn btn-secondary searchBtn" type="submit">Í≤ÄÏÉâ</button>
                                    </div>
                                </div>
                        </form>
<!--                        <a class="notice-write-btn"-->
<!--                           th:if="${#authorization.expression('hasRole(''ADMIN'')')}"-->
<!--                           href="/notices/register">-->
                        <a class="notice-write-btn" href="/notices/register">
                           <!--th:if="${#authorization.expression('hasRole(''ADMIN'')')}"-->
                            ÏûëÏÑ±ÌïòÍ∏∞
                        </a>
                    </div>

                    <table class="notice-table">
                        <thead>
                        <tr>
                            <th>No</th>
                            <th>Ï†úÎ™©</th>
                            <th>ÏûëÏÑ±Ïûê</th>
                            <th>ÏûëÏÑ±Ïùº</th>
                            <th>Ï°∞ÌöåÏàò</th>
                        </tr>
                        </thead>
                        <tbody th:with="link=${pageRequestDTO.getLink()}">
                        <tr th:each="notices:${responseDTO.dtoList}">
                            <td>[[${notices.noticeNum}]]</td>
                            <td>
                                <a th:href="|@{/notices/read(noticeNum=${notices.noticeNum})}&${link}|"class="notice-link">
                                    [[${notices.title}]]
                                </a>
                            </td>
                            <td> [[${notices.members_username}]]</td>
                            <td th:text="${#temporals.format(notices.regDate, 'yyyy.MM.dd HH:mm')}"></td>
                            <td>[[${notices.hitcount}]]</td>
                        </tr>
                    </tbody>
                </table>
                    <div class="float-end">
                        <ul class="pagination">
                            <li class="page-item" th:if="${responseDTO.prev}">
                                <a class="page-link" th:data-num="${responseDTO.start -1}">Previous</a>
                            </li>
                            <th:block th:each="i:${#numbers.sequence(responseDTO.start, responseDTO.end)}">
                                <li th:class="${responseDTO.page==i}?'page-item active':'page-item'">
                                    <a class="page-link" th:data-num="${i}">[[${i}]]</a>
                                </li>
                            </th:block>
                            <li class="page-item" th:if="${responseDTO.next}">
                                <a class="page-link" th:data-num="${responseDTO.end +1}">Next</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script layout:fragment="script" th:inline="javascript">
        document.querySelector(".pagination").addEventListener("click",function (e){
            e.preventDefault()
            e.stopPropagation()
            const target=e.target
            if(target.tagName!=='A'){
                return
            }
            const num=target.getAttribute("data-num")
            const formObj=document.querySelector("form")
            formObj.innerHTML += `<input type='hidden' name='page' value='${num}'>`
            formObj.submit()
            //self.location=`/board/list?page=${num}`
        },false)
    </script>
</html>
